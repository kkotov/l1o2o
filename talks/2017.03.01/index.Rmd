---
title       : "L1T O2O status"
subtitle    : 
author      : Khristian Kotov
job         : 
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
github:
  user: kkotov 
  repo: talks
url:
  lib:    ../../../../monohiggs/plots/libraries
  assets: ../../../../monohiggs/plots/assets
widgets     : [mathjax]     # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
--- &twocol

## Recap of L1T O2O in 2016

L1 trigger upgrade of 2015 rendered obsolete all of the system-specific O2O code

New code was gradually put in place through summer while running in the development mode
(the run-critical uGT/L1Menu was prepared already in 2015 and always ran in production)

In the end of 2016 all (but CaloParams) payloads/tags were moved from Dev DB to Prod DB:

*** =left

System     |   Payload[Tag]
-----------|-----------------
uGT        | <span style="font-weight:bold;font-size:smaller;color:green">L1TUtmTriggerMenu[_Stage2v0_hlt]</span>
uGT RS     | <span style="font-weight:bold;font-size:smaller;color:green">L1TGlobalPrescalesVetos[_Stage2v0_hlt]</span>
CALOL{1,2} | <span style="font-weight:bold;font-size:smaller;color:green">L1TCaloParams[_Stage2v0_hlt]</span>
uGMT       | <span style="font-weight:bold;font-size:smaller;color:green">L1TMuonGlobalParams[_Stage2v0_hlt]</span>

*** =right

System     |   Payload[Tag]
-----------|-----------------
BMTF       | <span style="font-weight:bold;font-size:smaller;color:green">L1TMuonBarrelParams[_Stage2v0_hlt]</span>
OMTF       | <span style="font-weight:bold;font-size:smaller;color:green">L1TMuonOverlapParams[_Stage2v0_hlt]</span>
EMTF       | <span style="font-weight:bold;font-size:smaller;color:green">L1TMuonEndCapParams[_Stage2v0_hlt]</span>
O2O        | <span style="font-weight:bold;font-size:smaller;color:green">L1TriggerKey(List)[_Stage2v0_hlt]</span>

*** =fullwidth
<br>

Additional <span style="font-weight:bold;font-size:smaller;color:green">L1TMuonEndCapForests[_Stage2v0_hlt]</span>
payload was prepared for EMTF but never used as the pT LUT neven changed in 2016

--- .class #id

## L1T O2O infrastructure 

Job is envoked by SWATCH central cell in the end of configuration cycle and does the following:
* with the given TSC key it navigates through subsystem tables and fetches the XMLs
  (online DB offers 3 tables per subsystem as explained in [slide 5](https://indico.cern.ch/event/591003/contributions/2384788/attachments/1378957/2095301/L1TriggerDatabase_v2.pdf))
* it parses the XMLs and packs offline-relevant parameters in payloads
* it pushes the payloads to offline DB and stamps them with run-based IOV ([slide 4](http://kkotov.github.io/l1o2o/talks/2016.04.19/#4))

One of the requirement is to start with pre-initialized payloads (CMSSW static configs or prototype payloads)
and override a subset of parameters with values extracted from online DB 

So, in a nutshell the L1T O2O is a CMSSW job wrapped in series of scripts ([slide 5](http://kkotov.github.io/l1o2o/talks/2015.04.20/#5))

--- .class #id

## Subsystem-specific workflows and comments

<span style="font-weight:bold;color:brown">uGT:</span>
[UTM XML-parsing library](https://gitlab.cern.ch/cms-l1t-utm/utm) changes when new triggers are introduced in L1Menu
* as agreed with AlCa, the library update comes only with a new central CMSSW installation

<span style="font-weight:bold;color:brown">uGTrs:</span>
manually composed XML with errors crashed L1T O2O few times
* with the new L1CE service and new FM ploicy this is not expected to recure

<span style="font-weight:bold;color:brown">CALO:</span> a rather compex 
* the eta-compress LUT is not in online DB, the prototype payload  


--- .class #id

## Experimental ...


--- .class #id


New online software was finalizing configuration DB schema in [May 2016](http://cactus.web.cern.ch/cactus/release/swatch/0.12/doc/html/releaseNotes/v0_9_0.html)

Subsystems were actively developing their new XML configs through the same time

An xerces-based XML parser for the O2O has been completed through early summer

Most of subsystem provided their new system-specific O2O code through summer-fall
* uGT was first with their independent UTM xml-parsing library developed in 2015!


L1T upgrade related O2O PRs:
[15204](https://github.com/cms-sw/cmssw/pull/15204),
[15846](https://github.com/cms-sw/cmssw/pull/15846),
[16693](https://github.com/cms-sw/cmssw/pull/16693),
[16664](https://github.com/cms-sw/cmssw/pull/16664),
[17059](https://github.com/cms-sw/cmssw/pull/17059),
[17295](https://github.com/cms-sw/cmssw/pull/17295),
[17461](https://github.com/cms-sw/cmssw/pull/17461),
[17641](https://github.com/cms-sw/cmssw/pull/17641)


cmssw job 

Online:
* 
*

Offile:


--- .class #id

## L1Trigger payloads and tags



